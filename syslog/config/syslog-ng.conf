@version: 4.8

options {
    time-reap(60);                 # Membersihkan state setiap 60 detik (lebih hemat sumber daya)
    mark-freq(1200);               # Mengurangi frekuensi pesan mark (setiap 20 menit)
    keep-hostname(yes);            # Menjaga hostname asli
    log-msg-size(65536);           # Ukuran maksimal pesan log (tetap sama)
    stats(freq(600));              # Statistik setiap 10 menit
    threaded(yes);                 # Mengaktifkan threading untuk kinerja tinggi
    flush-lines(0);                # Flush pesan log langsung (real-time)
    chain-hostnames(no);           # Nonaktifkan chain hostnames untuk log ringkas
};

# Source untuk menerima log dari jaringan (UDP dan TCP)
source s_network {
    network(
        ip("0.0.0.0")
        port(1514)
        transport("udp")
    );
    network(
        ip("0.0.0.0")
        port(1514)
        transport("tcp")
    );
};

# Filter untuk log Debug
filter f_debug {
    level(debug..emerg);
};

# Filter untuk log RTSP
filter f_rtsp {
    match("(?i)RTSP" value("MESSAGE"));
};

# Filter untuk log Test
filter f_test {
    match("(?i)Test" value("MESSAGE"));
};

# Filter untuk log HDD Monitoring
filter f_hdd_status {
    match("(?i)HDD-STATUS" value("MESSAGE"));
};

# Filter untuk log AUTH
filter f_auth {
    match("(?i)AUTH" value("MESSAGE"));
};

# Filter untuk log STREAMING-HLS
filter f_streaming_hls {
    match("(?i)STREAMING-HLS" value("MESSAGE"));
};

# Filter untuk log NETWORK
filter f_network {
    match("(?i)NETWORK" value("MESSAGE"));
};

# Filter untuk log PERFORMANCE
filter f_performance {
    match("(?i)PERFORMANCE" value("MESSAGE"));
};

# Filter untuk log BACKUP
filter f_backup {
    match("(?i)BACKUP" value("MESSAGE"));
};

# Filter untuk log SECURITY
filter f_security {
    match("(?i)SECURITY" value("MESSAGE"));
};

# Filter untuk log ALERTS
filter f_alerts {
    match("(?i)ALERTS" value("MESSAGE"));
};

# Filter untuk log AUDIT
filter f_audit {
    match("(?i)AUDIT" value("MESSAGE"));
};

# Filter untuk log SCHEDULER
filter f_scheduler {
    match("(?i)SCHEDULER" value("MESSAGE"));
};

# Template untuk format timestamp dd-MM-yyyy
template t_custom {
    template("${DAY}-${MONTH}-${YEAR} ${HOUR}:${MIN}:${SEC} ${HOST} ${PROGRAM}: ${MSG}\n");
    template_escape(no);
};

# Destination untuk log Debug
destination d_debug {
    file("/mnt/Data/Syslog/debug/debug.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log RTSP
destination d_rtsp {
    file("/mnt/Data/Syslog/rtsp/rtsp.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log Test
destination d_test {
    file("/mnt/Data/Syslog/test/test.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log HDD Monitoring
destination d_hdd_status {
    file("/mnt/Data/Syslog/hdd/hdd_monitor.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log AUTH
destination d_auth {
    file("/mnt/Data/Syslog/auth/auth.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log STREAMING-HLS
destination d_streaming_hls {
    file("/mnt/Data/Syslog/streaming/hls.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log NETWORK
destination d_network {
    file("/mnt/Data/Syslog/network/network.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log PERFORMANCE
destination d_performance {
    file("/mnt/Data/Syslog/performance/performance.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log BACKUP
destination d_backup {
    file("/mnt/Data/Syslog/backup/backup.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log SECURITY
destination d_security {
    file("/mnt/Data/Syslog/security/security.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log ALERTS
destination d_alerts {
    file("/mnt/Data/Syslog/alerts/alerts.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log AUDIT
destination d_audit {
    file("/mnt/Data/Syslog/audit/audit.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log SCHEDULER
destination d_scheduler {
    file("/mnt/Data/Syslog/scheduler/scheduler.log" create-dirs(yes)
         template(t_custom));
};

# Destination untuk log Default (jika tidak ada filter cocok)
destination d_default {
    file("/mnt/Data/Syslog/default/default.log" create-dirs(yes)
         template(t_custom));
};

# Log path untuk log Debug
log {
    source(s_network);
    filter(f_debug);
    destination(d_debug);
};

# Log path untuk log RTSP
log {
    source(s_network);
    filter(f_rtsp);
    destination(d_rtsp);
};

# Log path untuk log Test
log {
    source(s_network);
    filter(f_test);
    destination(d_test);
};

# Log path untuk HDD Monitoring
log {
    source(s_network);
    filter(f_hdd_status);
    destination(d_hdd_status);
};

# Log path untuk AUTH
log {
    source(s_network);
    filter(f_auth);
    destination(d_auth);
};

# Log path untuk STREAMING-HLS
log {
    source(s_network);
    filter(f_streaming_hls);
    destination(d_streaming_hls);
};

# Log path untuk NETWORK
log {
    source(s_network);
    filter(f_network);
    destination(d_network);
};

# Log path untuk PERFORMANCE
log {
    source(s_network);
    filter(f_performance);
    destination(d_performance);
};

# Log path untuk BACKUP
log {
    source(s_network);
    filter(f_backup);
    destination(d_backup);
};

# Log path untuk SECURITY
log {
    source(s_network);
    filter(f_security);
    destination(d_security);
};

# Log path untuk ALERTS
log {
    source(s_network);
    filter(f_alerts);
    destination(d_alerts);
};

# Log path untuk AUDIT
log {
    source(s_network);
    filter(f_audit);
    destination(d_audit);
};

# Log path untuk SCHEDULER
log {
    source(s_network);
    filter(f_scheduler);
    destination(d_scheduler);
};

# Log path untuk log Default
log {
    source(s_network);
    destination(d_default);
};